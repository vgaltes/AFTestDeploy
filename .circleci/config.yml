version: 2
jobs:
  build:
    docker:
      - image: vicencgarcia/azurefunctionsbuildanddeploy:1.0

    working_directory: ~/repo

    steps:
      - checkout
      - run:
          name: Where I am
          command: pwd
      - run:
          name: Login into azure
          command: ./login.sh
      - run:
          name: Create local.settings.json
          command: |
            cat > local.setttings.json << EOF                                                                                                         âœ˜ 1
            {
                "IsEncrypted": false,
                "Values": {
                    "AzureWebJobsStorage": "",
                    "FUNCTIONS_WORKER_RUNTIME": "dotnet"
                }
            }
            EOF

      - run:
          name: Deploy
          command: ./deploy.sh AFTestDeploy westeurope uat
